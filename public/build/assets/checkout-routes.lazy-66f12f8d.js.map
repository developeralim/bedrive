{"version":3,"file":"checkout-routes.lazy-66f12f8d.js","sources":["../../../common/foundation/resources/client/billing/checkout/checkout-layout.tsx","../../../common/foundation/resources/client/billing/requests/use-checkout-product.ts","../../../common/foundation/resources/client/billing/checkout/checkout-product-summary.tsx","../../../node_modules/@paypal/paypal-js/dist/esm/paypal-js.js","../../../common/foundation/resources/client/billing/checkout/paypal/use-paypal.ts","../../../common/foundation/resources/client/billing/checkout/checkout.tsx","../../../common/foundation/resources/client/uploads/requests/use-file-entry-model.ts","../../../common/foundation/resources/client/billing/checkout/purchase.tsx","../../../common/foundation/resources/client/billing/checkout/stripe/checkout-stripe-done.tsx","../../../common/foundation/resources/client/billing/checkout/paypal/checkout-paypal-done.tsx"],"sourcesContent":["import {Fragment, ReactElement, useEffect} from 'react';\r\nimport {Navbar} from '../../ui/navigation/navbar/navbar';\r\nimport {CustomMenu} from '../../menus/custom-menu';\r\nimport {LocaleSwitcher} from '@common/locale-switcher/locale-switcher';\r\nimport {removeFromLocalStorage} from '@ui/utils/hooks/local-storage';\r\nimport {StaticPageTitle} from '../../seo/static-page-title';\r\nimport {Trans} from '@ui/i18n/trans';\r\n\r\ninterface CheckoutLayoutProps {\r\n  children: [ReactElement, ReactElement];\r\n}\r\nexport function CheckoutLayout({children}: CheckoutLayoutProps) {\r\n  const [left, right] = children;\r\n\r\n  useEffect(() => {\r\n    removeFromLocalStorage('be.onboarding.selected');\r\n  }, []);\r\n\r\n  return (\r\n    <Fragment>\r\n      <StaticPageTitle>\r\n        <Trans message=\"Checkout\" />\r\n      </StaticPageTitle>\r\n      <Navbar\r\n        size=\"sm\"\r\n        color=\"transparent\"\r\n        className=\"z-10 mb-20 md:mb-0\"\r\n        textColor=\"text-main\"\r\n        logoColor=\"dark\"\r\n        darkModeColor=\"transparent\"\r\n        menuPosition=\"checkout-page-navbar\"\r\n      />\r\n      <div className=\"mx-auto w-full justify-between px-20 md:flex md:max-w-950 md:px-0 md:pt-128\">\r\n        <div className=\"fixed right-0 top-0 hidden h-full w-1/2 bg-alt shadow-[15px_0_30px_0_rgb(0_0_0_/_18%)] md:block\" />\r\n        <div className=\"overflow-hidden md:w-400\">\r\n          {left}\r\n          <CustomMenu\r\n            menu=\"checkout-page-footer\"\r\n            className=\"mt-50 overflow-x-auto text-xs text-muted\"\r\n          />\r\n          <div className=\"mt-40\">\r\n            <LocaleSwitcher />\r\n          </div>\r\n        </div>\r\n        <div className=\"hidden w-384 md:block\">\r\n          <div className=\"relative z-10\">{right}</div>\r\n        </div>\r\n      </div>\r\n    </Fragment>\r\n  );\r\n}\r\n","import {keepPreviousData, useQuery} from '@tanstack/react-query';\r\nimport {apiClient} from '../../http/query-client';\r\nimport {BackendResponse} from '../../http/backend-response/backend-response';\r\nimport {Product} from '../product';\r\nimport {useParams} from 'react-router';\r\n\r\nconst endpoint = (productId: string | number) =>\r\n  `billing/products/${productId}`;\r\n\r\nexport interface FetchProductResponse extends BackendResponse {\r\n  product: Product;\r\n}\r\n\r\nexport function useCheckoutProduct() {\r\n  const {productId, priceId} = useParams();\r\n  const query = useQuery({\r\n    queryKey: [endpoint(productId!)],\r\n    queryFn: () => fetchProduct(productId!),\r\n    placeholderData: keepPreviousData,\r\n    enabled: productId != null && priceId != null,\r\n  });\r\n\r\n  const product = query.data?.product;\r\n  const price =\r\n    product?.prices.find(p => p.id === parseInt(priceId!)) ||\r\n    product?.prices[0];\r\n\r\n  return {status: query.status, product, price};\r\n}\r\n\r\nfunction fetchProduct(\r\n  productId: string | number,\r\n): Promise<FetchProductResponse> {\r\n  return apiClient.get(endpoint(productId)).then(response => response.data);\r\n}\r\n","import {Trans} from '@ui/i18n/trans';\r\nimport {FormattedPrice} from '@common/billing/formatted-price';\r\nimport {useCheckoutProduct} from '@common/billing/requests/use-checkout-product';\r\nimport {m} from 'framer-motion';\r\nimport {Skeleton} from '@ui/skeleton/skeleton';\r\nimport {Product} from '@common/billing/product';\r\nimport {Price} from '@common/billing/price';\r\nimport {ProductFeatureList} from '../pricing-table/product-feature-list';\r\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\r\nimport {FormattedCurrency} from '@ui/i18n/formatted-currency';\r\n\r\ninterface CheckoutProductSummaryProps {\r\n  showBillingLine?: boolean;\r\n}\r\nexport function CheckoutProductSummary({\r\n  showBillingLine = true,\r\n}: CheckoutProductSummaryProps) {\r\n  const {status, product, price} = useCheckoutProduct();\r\n\r\n  if (status === 'error' || (status !== 'pending' && (!product || !price))) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"mb-30 text-2xl\">\r\n        <Trans message=\"Summary\" />\r\n      </h2>\r\n      {status === 'pending' ? (\r\n        <LoadingSkeleton key=\"loading-skeleton\" />\r\n      ) : (\r\n        <ProductSummary\r\n          product={product!}\r\n          price={price!}\r\n          showBillingLine={showBillingLine}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface ProductSummaryProps {\r\n  product: Product;\r\n  price: Price;\r\n  showBillingLine: boolean;\r\n}\r\nfunction ProductSummary({\r\n  product,\r\n  price,\r\n  showBillingLine,\r\n}: ProductSummaryProps) {\r\n  return (\r\n    <m.div>\r\n      <div className=\"mb-6 text-xl font-semibold\">{product.name}</div>\r\n      {product.description && (\r\n        <div className=\"text-sm text-muted\">{product.description}</div>\r\n      )}\r\n      <FormattedPrice\r\n        priceClassName=\"font-bold text-4xl\"\r\n        periodClassName=\"text-muted text-xs\"\r\n        variant=\"separateLine\"\r\n        price={price}\r\n        className=\"mt-32\"\r\n      />\r\n      <ProductFeatureList product={product} />\r\n      {showBillingLine && (\r\n        <div className=\"mt-32 flex items-center justify-between gap-24 border-t pt-24 font-medium\">\r\n          <div>\r\n            <Trans message=\"Billed today\" />\r\n          </div>\r\n          <div>\r\n            <FormattedCurrency value={price.amount} currency={price.currency} />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </m.div>\r\n  );\r\n}\r\n\r\nfunction LoadingSkeleton() {\r\n  return (\r\n    <m.div {...opacityAnimation} className=\"max-w-180\">\r\n      <Skeleton className=\"mb-6 text-xl\" />\r\n      <Skeleton className=\"text-sm\" />\r\n      <Skeleton className=\"mt-32 text-4xl\" />\r\n    </m.div>\r\n  );\r\n}\r\n","/*!\n * paypal-js v7.0.3 (2023-09-19T14:17:47.731Z)\n * Copyright 2020-present, PayPal, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction findScript(url, attributes) {\n    var currentScript = document.querySelector(\"script[src=\\\"\".concat(url, \"\\\"]\"));\n    if (currentScript === null)\n        return null;\n    var nextScript = createScriptElement(url, attributes);\n    // ignore the data-uid-auto attribute that gets auto-assigned to every script tag\n    var currentScriptClone = currentScript.cloneNode();\n    delete currentScriptClone.dataset.uidAuto;\n    // check if the new script has the same number of data attributes\n    if (Object.keys(currentScriptClone.dataset).length !==\n        Object.keys(nextScript.dataset).length) {\n        return null;\n    }\n    var isExactMatch = true;\n    // check if the data attribute values are the same\n    Object.keys(currentScriptClone.dataset).forEach(function (key) {\n        if (currentScriptClone.dataset[key] !== nextScript.dataset[key]) {\n            isExactMatch = false;\n        }\n    });\n    return isExactMatch ? currentScript : null;\n}\nfunction insertScriptElement(_a) {\n    var url = _a.url, attributes = _a.attributes, onSuccess = _a.onSuccess, onError = _a.onError;\n    var newScript = createScriptElement(url, attributes);\n    newScript.onerror = onError;\n    newScript.onload = onSuccess;\n    document.head.insertBefore(newScript, document.head.firstElementChild);\n}\nfunction processOptions(options) {\n    var sdkBaseUrl = \"https://www.paypal.com/sdk/js\";\n    if (options.sdkBaseUrl) {\n        sdkBaseUrl = options.sdkBaseUrl;\n        delete options.sdkBaseUrl;\n    }\n    var optionsWithStringIndex = options;\n    var _a = Object.keys(optionsWithStringIndex)\n        .filter(function (key) {\n        return (typeof optionsWithStringIndex[key] !== \"undefined\" &&\n            optionsWithStringIndex[key] !== null &&\n            optionsWithStringIndex[key] !== \"\");\n    })\n        .reduce(function (accumulator, key) {\n        var value = optionsWithStringIndex[key].toString();\n        key = camelCaseToKebabCase(key);\n        if (key.substring(0, 4) === \"data\") {\n            accumulator.dataAttributes[key] = value;\n        }\n        else {\n            accumulator.queryParams[key] = value;\n        }\n        return accumulator;\n    }, {\n        queryParams: {},\n        dataAttributes: {},\n    }), queryParams = _a.queryParams, dataAttributes = _a.dataAttributes;\n    if (queryParams[\"merchant-id\"] &&\n        queryParams[\"merchant-id\"].indexOf(\",\") !== -1) {\n        dataAttributes[\"data-merchant-id\"] = queryParams[\"merchant-id\"];\n        queryParams[\"merchant-id\"] = \"*\";\n    }\n    return {\n        url: \"\".concat(sdkBaseUrl, \"?\").concat(objectToQueryString(queryParams)),\n        dataAttributes: dataAttributes,\n    };\n}\nfunction camelCaseToKebabCase(str) {\n    var replacer = function (match, indexOfMatch) {\n        return (indexOfMatch ? \"-\" : \"\") + match.toLowerCase();\n    };\n    return str.replace(/[A-Z]+(?![a-z])|[A-Z]/g, replacer);\n}\nfunction objectToQueryString(params) {\n    var queryString = \"\";\n    Object.keys(params).forEach(function (key) {\n        if (queryString.length !== 0)\n            queryString += \"&\";\n        queryString += key + \"=\" + params[key];\n    });\n    return queryString;\n}\nfunction createScriptElement(url, attributes) {\n    if (attributes === void 0) { attributes = {}; }\n    var newScript = document.createElement(\"script\");\n    newScript.src = url;\n    Object.keys(attributes).forEach(function (key) {\n        newScript.setAttribute(key, attributes[key]);\n        if (key === \"data-csp-nonce\") {\n            newScript.setAttribute(\"nonce\", attributes[\"data-csp-nonce\"]);\n        }\n    });\n    return newScript;\n}\n\n/**\n * Load the Paypal JS SDK script asynchronously.\n *\n * @param {Object} options - used to configure query parameters and data attributes for the JS SDK.\n * @param {PromiseConstructor} [PromisePonyfill=window.Promise] - optional Promise Constructor ponyfill.\n * @return {Promise<Object>} paypalObject - reference to the global window PayPal object.\n */\nfunction loadScript(options, PromisePonyfill) {\n    if (PromisePonyfill === void 0) { PromisePonyfill = Promise; }\n    validateArguments(options, PromisePonyfill);\n    // resolve with null when running in Node or Deno\n    if (typeof document === \"undefined\")\n        return PromisePonyfill.resolve(null);\n    var _a = processOptions(options), url = _a.url, dataAttributes = _a.dataAttributes;\n    var namespace = dataAttributes[\"data-namespace\"] || \"paypal\";\n    var existingWindowNamespace = getPayPalWindowNamespace(namespace);\n    // resolve with the existing global paypal namespace when a script with the same params already exists\n    if (findScript(url, dataAttributes) && existingWindowNamespace) {\n        return PromisePonyfill.resolve(existingWindowNamespace);\n    }\n    return loadCustomScript({\n        url: url,\n        attributes: dataAttributes,\n    }, PromisePonyfill).then(function () {\n        var newWindowNamespace = getPayPalWindowNamespace(namespace);\n        if (newWindowNamespace) {\n            return newWindowNamespace;\n        }\n        throw new Error(\"The window.\".concat(namespace, \" global variable is not available.\"));\n    });\n}\n/**\n * Load a custom script asynchronously.\n *\n * @param {Object} options - used to set the script url and attributes.\n * @param {PromiseConstructor} [PromisePonyfill=window.Promise] - optional Promise Constructor ponyfill.\n * @return {Promise<void>} returns a promise to indicate if the script was successfully loaded.\n */\nfunction loadCustomScript(options, PromisePonyfill) {\n    if (PromisePonyfill === void 0) { PromisePonyfill = Promise; }\n    validateArguments(options, PromisePonyfill);\n    var url = options.url, attributes = options.attributes;\n    if (typeof url !== \"string\" || url.length === 0) {\n        throw new Error(\"Invalid url.\");\n    }\n    if (typeof attributes !== \"undefined\" && typeof attributes !== \"object\") {\n        throw new Error(\"Expected attributes to be an object.\");\n    }\n    return new PromisePonyfill(function (resolve, reject) {\n        // resolve with undefined when running in Node or Deno\n        if (typeof document === \"undefined\")\n            return resolve();\n        insertScriptElement({\n            url: url,\n            attributes: attributes,\n            onSuccess: function () { return resolve(); },\n            onError: function () {\n                var defaultError = new Error(\"The script \\\"\".concat(url, \"\\\" failed to load. Check the HTTP status code and response body in DevTools to learn more.\"));\n                return reject(defaultError);\n            },\n        });\n    });\n}\nfunction getPayPalWindowNamespace(namespace) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return window[namespace];\n}\nfunction validateArguments(options, PromisePonyfill) {\n    if (typeof options !== \"object\" || options === null) {\n        throw new Error(\"Expected an options object.\");\n    }\n    if (typeof PromisePonyfill !== \"undefined\" &&\n        typeof PromisePonyfill !== \"function\") {\n        throw new Error(\"Expected PromisePonyfill to be a function.\");\n    }\n}\n\n// replaced with the package.json version at build time\nvar version = \"7.0.3\";\n\nexport { loadCustomScript, loadScript, version };\n","import { useEffect, useRef, useState } from 'react';\r\nimport { loadScript } from '@paypal/paypal-js';\r\nimport { useProducts } from '@common/billing/pricing-table/use-products';\r\nimport { useSettings } from '@ui/settings/use-settings';\r\n\r\ninterface UsePaypalProps {\r\n  type         : 'subscription' | 'capture';\r\n  productId   ?: string;\r\n  priceId     ?: string;\r\n  entry_id    ?: string;\r\n  entry_price ?: string;\r\n}\r\n\r\nexport function usePaypal({ productId, priceId, type, entry_id, entry_price }: UsePaypalProps) {\r\n  const { data } = useProducts();\r\n  const paypalLoadStarted = useRef<boolean>(false);\r\n  const paypalButtonsRendered = useRef<boolean>(false);\r\n  const [paypalIsLoaded, setPaypalIsLoaded] = useState(false);\r\n  const paypalElementRef = useRef<HTMLDivElement>(null);\r\n  const {\r\n    base_url,\r\n    billing: {\r\n      stripe: { enable: stripeEnabled },\r\n      paypal: { enable: paypalEnabled, public_key },\r\n    },\r\n  } = useSettings();\r\n\r\n  useEffect(() => {\r\n    if (!paypalEnabled || !public_key || paypalLoadStarted.current) return;\r\n    loadScript({\r\n      clientId: public_key,\r\n      intent: type,\r\n      vault: true,\r\n      disableFunding: stripeEnabled ? 'card' : undefined,\r\n    }).then(() => {\r\n      setPaypalIsLoaded(true);\r\n    });\r\n    paypalLoadStarted.current = true;\r\n  }, [public_key, paypalEnabled, stripeEnabled]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      !paypalIsLoaded ||\r\n      !window.paypal?.Buttons ||\r\n      !paypalElementRef.current ||\r\n      !data?.products.length ||\r\n      !productId ||\r\n      !priceId ||\r\n      paypalButtonsRendered.current\r\n    )\r\n      return;\r\n\r\n    const product = data.products.find(p => p.id === parseInt(productId));\r\n    const price = product?.prices.find(p => p.id === parseInt(priceId));\r\n\r\n    let buttons;\r\n\r\n    if (type === 'subscription') {\r\n      buttons = window.paypal\r\n        .Buttons({\r\n          style: {\r\n            label: 'pay',\r\n          },\r\n          createSubscription: (data, actions) => {\r\n            return actions.subscription.create({\r\n              application_context: {\r\n                shipping_preference: 'NO_SHIPPING',\r\n              },\r\n              plan_id: price?.paypal_id!,\r\n            });\r\n          },\r\n          onApprove: (data, actions) => {\r\n            actions.redirect(\r\n              `${base_url}/checkout/${productId}/${priceId}/paypal/done?subscriptionId=${data.subscriptionID}&status=success`\r\n            );\r\n            return Promise.resolve();\r\n          },\r\n          onError: e => {\r\n            location.href = `${base_url}/checkout/${productId}/${priceId}/paypal/done?status=error`;\r\n          },\r\n        });\r\n    } else {\r\n      buttons = window.paypal.Buttons({\r\n        style: { label: 'pay' },\r\n        createOrder: (data, actions) => {\r\n          return actions.order.create({\r\n            purchase_units: [\r\n              {\r\n                amount: {\r\n                  value: entry_price ?? '0.00',\r\n                  currency_code: 'USD',\r\n                },\r\n              },\r\n            ],\r\n            application_context: { shipping_preference: 'NO_SHIPPING' },\r\n          });\r\n        },\r\n        onApprove: async (data, actions) => {\r\n          if (!actions.order) return;\r\n          const order = await actions.order.capture();\r\n          location.href = `${base_url}/purchase/${entry_id}/paypal/done?orderId=${order.id}&status=success`;\r\n        },\r\n        onError: () => {\r\n          location.href = `${base_url}/purchase/${entry_id}/paypal/done?status=error`;\r\n        },\r\n      });\r\n    }\r\n\r\n    buttons.render(paypalElementRef.current).then(() => {\r\n      paypalButtonsRendered.current = true;\r\n    });\r\n\r\n  }, [productId, priceId, data, paypalIsLoaded, base_url]);\r\n\r\n  return {\r\n    paypalElementRef,\r\n    stripeIsEnabled: public_key != null && paypalEnabled,\r\n  };\r\n}\r\n","import {Navigate, useParams} from 'react-router';\r\nimport {Trans} from '@ui/i18n/trans';\r\nimport {CheckoutLayout} from './checkout-layout';\r\nimport {CheckoutProductSummary} from './checkout-product-summary';\r\nimport {usePaypal} from './paypal/use-paypal';\r\nimport {StripeElementsForm} from './stripe/stripe-elements-form';\r\nimport {Fragment} from 'react';\r\nimport {useProducts} from '../pricing-table/use-products';\r\nimport {FullPageLoader} from '@ui/progress/full-page-loader';\r\nimport {useSettings} from '@ui/settings/use-settings';\r\n\r\nexport function Checkout() {\r\n  const {productId, priceId} = useParams();\r\n  const productQuery = useProducts();\r\n  const {paypalElementRef} = usePaypal({\r\n    productId,\r\n    priceId,\r\n    type: 'subscription'\r\n  });\r\n  const {\r\n    base_url,\r\n    billing: {stripe},\r\n  } = useSettings();\r\n\r\n  if (productQuery.isLoading) {\r\n    return <FullPageLoader screen />;\r\n  }\r\n\r\n  const product = productQuery.data?.products.find(\r\n    p => p.id === parseInt(productId!),\r\n  );\r\n  const price = product?.prices.find(p => p.id === parseInt(priceId!));\r\n\r\n  // make sure product and price exists in backend\r\n  if (!product || !price || productQuery.status === 'error') {\r\n    return <Navigate to=\"/pricing\" replace />;\r\n  }\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <Fragment>\r\n        <h1 className=\"mb-40 text-4xl\">\r\n          <Trans message=\"Checkout\" />\r\n        </h1>\r\n        {stripe.enable ? (\r\n          <Fragment>\r\n            <StripeElementsForm\r\n              productId={productId}\r\n              priceId={priceId}\r\n              submitLabel={<Trans message=\"Upgrade\" />}\r\n              type=\"subscription\"\r\n              returnUrl={`${base_url}/checkout/${productId}/${priceId}/stripe/done?type=subscription`}\r\n            />\r\n            <Separator />\r\n          </Fragment>\r\n        ) : null}\r\n        <div ref={paypalElementRef} />\r\n        <div className=\"mt-30 text-xs text-muted\">\r\n          <Trans message=\"You’ll be charged until you cancel your subscription. Previous charges won’t be refunded when you cancel unless it’s legally required. Your payment data is encrypted and secure. By subscribing your agree to our terms of service and privacy policy.\" />\r\n        </div>\r\n      </Fragment>\r\n      <CheckoutProductSummary />\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction Separator() {\r\n  return (\r\n    <div className=\"relative my-20 text-center before:absolute before:left-0 before:top-1/2 before:h-1 before:w-full before:-translate-y-1/2 before:bg-divider\">\r\n      <span className=\"relative z-10 bg px-10 text-sm text-muted\">\r\n        <Trans message=\"or\" />\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n","import {useQuery} from '@tanstack/react-query';\r\nimport {apiClient} from '@common/http/query-client';\r\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\r\nimport {FileEntry} from '@common/uploads/file-entry';\r\n\r\ninterface Response extends BackendResponse {\r\n  fileEntry: FileEntry;\r\n}\r\n\r\ninterface Options {\r\n  enabled?: boolean;\r\n}\r\n\r\nexport function useFileEntryModel(\r\n  entryIdOrUrl: number | string | undefined,\r\n  options: Options = {enabled: true},\r\n) {\r\n  const entryId = extractEntryId(entryIdOrUrl);\r\n  return useQuery({\r\n    queryKey: ['file-entries', `${entryId}`],\r\n    queryFn: () => fetchFileEntry(entryId!),\r\n    enabled: !!entryId && options.enabled,\r\n  });\r\n}\r\n\r\nfunction fetchFileEntry(entryId: number | string) {\r\n  return apiClient\r\n    .get<Response>(`file-entries/${entryId}/model`)\r\n    .then(response => response.data);\r\n}\r\n\r\nfunction extractEntryId(entryIdOrUrl: number | string | undefined) {\r\n  if (!entryIdOrUrl) {\r\n    return undefined;\r\n  }\r\n  const parsedId = parseInt(entryIdOrUrl as string);\r\n  if (!isNaN(parsedId)) {\r\n    return parsedId;\r\n  }\r\n  return `${entryIdOrUrl}`.split('/').pop();\r\n}\r\n","import { Navigate, useParams } from 'react-router';\r\nimport { Trans } from '@ui/i18n/trans';\r\nimport { CheckoutLayout } from './checkout-layout';\r\nimport { CheckoutProductSummary } from './checkout-product-summary';\r\nimport { StripeElementsForm } from './stripe/stripe-elements-form';\r\nimport { Fragment } from 'react';\r\nimport { FullPageLoader } from '@ui/progress/full-page-loader';\r\nimport { useSettings } from '@ui/settings/use-settings';\r\nimport { useFileEntryModel } from '@common/uploads/requests/use-file-entry-model';\r\nimport { FormattedCurrency } from '@ui/i18n/formatted-currency';\r\nimport { message } from '@ui/i18n/message';\r\nimport { useTrans } from '@ui/i18n/use-trans';\r\nimport { usePaypal } from './paypal/use-paypal';\r\n\r\nexport function Purchase() {\r\n  const { entryId } = useParams();\r\n  const { paypalElementRef } = usePaypal({\r\n    entry_id: entryId,\r\n    type: 'capture'\r\n  });\r\n\r\n  const entryQuery = useFileEntryModel(entryId);\r\n\r\n  const {\r\n    base_url,\r\n    billing: { stripe },\r\n  } = useSettings();\r\n\r\n  if (entryQuery.isLoading) {\r\n    return <FullPageLoader screen />;\r\n  }\r\n\r\n  const entry = entryQuery.data?.fileEntry;\r\n\r\n  if (!entry) {\r\n    return <Navigate to='/drive/shares' />;\r\n  }\r\n\r\n  const entryModel = entry.users?.length ? entry.users[0] : null;\r\n\r\n  if (entryModel?.owns_entry || entryModel?.price === 0) {\r\n    return <Navigate to='/drive/shares' />;\r\n  }\r\n\r\n  const humanFileSize = (bytes = 0, decimals = 2) => {\r\n    if (bytes === 0) return '0 B';\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    const value = bytes / Math.pow(k, i);\r\n    return parseFloat(value.toFixed(decimals)) + ' ' + sizes[i];\r\n  }\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <Fragment>\r\n        <h1 className=\"mb-40 text-4xl\">\r\n          <Trans message=\"Purchse from original owner\" />\r\n        </h1>\r\n        {stripe.enable ? (\r\n          <Fragment>\r\n            <StripeElementsForm\r\n              submitLabel={<Trans message=\"Purchase Now\" />}\r\n              type=\"paymentIntent\"\r\n              returnUrl={`${base_url}/purchase/${entryId}/stripe/done?type=order`}\r\n              amount={10}\r\n            />\r\n            <Separator />\r\n          </Fragment>\r\n        ) : null}\r\n        <div ref={paypalElementRef} />\r\n      </Fragment>\r\n      <div>\r\n        <h1 className=\"mb-40 text-4xl\">\r\n          <Trans message=\"Summary\" />\r\n        </h1>\r\n        <table>\r\n          <tbody>\r\n            <tr>\r\n              <td><Trans message=\"Filename\" /></td>\r\n              <td>:</td>\r\n              <td><strong>{entry?.name}</strong></td>\r\n            </tr>\r\n            <tr>\r\n              <td><Trans message=\"Filesize\" /></td>\r\n              <td>:</td>\r\n              <td><strong>{humanFileSize(entry?.file_size)}</strong></td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <div className=\"flex items-center gap-6 mt-32\">\r\n          <div className=\"font-bold text-4xl\">\r\n            <FormattedCurrency value={entryModel?.price || 0} currency='USD' />\r\n          </div>\r\n        </div>\r\n        <div className=\"mt-32 flex items-center justify-between gap-24 border-t pt-24 font-medium\">\r\n          <div><Trans message='Billed Today' /></div>\r\n          <FormattedCurrency value={entryModel?.price || 0} currency='USD' />\r\n        </div>\r\n      </div>\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction Separator() {\r\n  return (\r\n    <div className=\"relative my-20 text-center before:absolute before:left-0 before:top-1/2 before:h-1 before:w-full before:-translate-y-1/2 before:bg-divider\">\r\n      <span className=\"relative z-10 bg px-10 text-sm text-muted\">\r\n        <Trans message=\"or\" />\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n","import {CheckoutLayout} from '../checkout-layout';\r\nimport {useParams, useSearchParams} from 'react-router';\r\nimport {loadStripe, PaymentIntent} from '@stripe/stripe-js';\r\nimport {useEffect, useRef, useState} from 'react';\r\nimport {message} from '@ui/i18n/message';\r\nimport {CheckoutProductSummary} from '../checkout-product-summary';\r\nimport {\r\n  BillingRedirectMessage,\r\n  BillingRedirectMessageConfig,\r\n} from '../../billing-redirect-message';\r\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\r\nimport {apiClient} from '@common/http/query-client';\r\nimport {useSettings} from '@ui/settings/use-settings';\r\n\r\nexport function CheckoutStripeDone() {\r\n  const {productId, priceId,type,entryId} = useParams();\r\n  const navigate = useNavigate();\r\n  const {\r\n    billing: {stripe_public_key},\r\n  } = useSettings();\r\n\r\n  const [params] = useSearchParams();\r\n  const clientSecret = params.get('payment_intent_client_secret');\r\n\r\n  const [messageConfig, setMessageConfig] =\r\n    useState<BillingRedirectMessageConfig>();\r\n\r\n  const stripeInitiated = useRef<boolean>();\r\n\r\n  useEffect(() => {\r\n    if (stripeInitiated.current) return;\r\n    loadStripe(stripe_public_key!).then(async stripe => {\r\n      if (!stripe || !clientSecret) {\r\n        setMessageConfig(getRedirectMessageConfig());\r\n        return;\r\n      }\r\n\r\n      const payment = stripe.retrievePaymentIntent(clientSecret)\r\n      if( type === 'subscription'){\r\n        payment.then(async ({paymentIntent}) => {\r\n          if (paymentIntent?.status === 'succeeded') {\r\n            await storeSubscriptionDetailsLocally(paymentIntent.id);\r\n            setMessageConfig(\r\n              getRedirectMessageConfig('succeeded', productId, priceId),\r\n            );\r\n            window.location.href = '/billing';\r\n          } else {\r\n            setMessageConfig(\r\n              getRedirectMessageConfig(\r\n                paymentIntent?.status,\r\n                productId,\r\n                priceId,\r\n              ),\r\n            );\r\n          }\r\n        });\r\n      }\r\n\r\n      if( type === 'order'){\r\n        payment.then(async ({paymentIntent}) => {\r\n          if (paymentIntent?.status === 'succeeded') {\r\n            await storePurchaseDetailsLocally(paymentIntent.id,entryId);\r\n            setMessageConfig(\r\n              getRedirectMessageConfig('purchased_succeeded', entryId),\r\n            );\r\n            window.location.href = '/billing';\r\n          } else {\r\n            setMessageConfig(\r\n              getRedirectMessageConfig(\r\n                paymentIntent?.status,\r\n                entryId\r\n              ),\r\n            );\r\n          }\r\n        });\r\n      }\r\n    });\r\n    stripeInitiated.current = true;\r\n  }, [stripe_public_key, clientSecret, priceId, productId,entryId,type]);\r\n\r\n  if (!clientSecret) {\r\n    navigate('/');\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <BillingRedirectMessage config={messageConfig} />\r\n      <CheckoutProductSummary showBillingLine={false} />\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction getRedirectMessageConfig(\r\n  status?: PaymentIntent.Status,\r\n  productId?: string,\r\n  priceId?: string,\r\n  entryId?: string,\r\n): BillingRedirectMessageConfig {\r\n  switch (status) {\r\n    case 'succeeded':\r\n      return {\r\n        message: message('Subscription successful!'),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: entryId ? '/drive/shares' : '/billing',\r\n      };\r\n    case 'processing':\r\n      return {\r\n        message: message(\r\n          \"Payment processing. We'll update you when payment is received.\",\r\n        ),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: entryId ? '/drive/shares' : '/billing',\r\n      };\r\n    case 'requires_payment_method':\r\n      return {\r\n        message: message('Payment failed. Please try another payment method.'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: entryId ? purchaseErrorLink(entryId) : errorLink(productId, priceId),\r\n      };\r\n    case 'purchased_succeeded':\r\n      return {\r\n        message: message('Payment failed. Please try another payment method.'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: purchaseErrorLink(entryId),\r\n      };\r\n    default:\r\n      return {\r\n        message: message('Something went wrong'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: entryId ? purchaseErrorLink(entryId) : errorLink(productId, priceId),\r\n      };\r\n  }\r\n}\r\n\r\nfunction purchaseErrorLink(entryId?: string): string {\r\n  return entryId ? `/purchase/${entryId}` : '/';\r\n}\r\n\r\nfunction errorLink(productId?: string, priceId?: string): string {\r\n  return productId && priceId ? `/checkout/${productId}/${priceId}` : '/';\r\n}\r\n\r\nfunction storeSubscriptionDetailsLocally(paymentIntentId: string) {\r\n  return apiClient.post('billing/stripe/store-subscription-details-locally', {\r\n    payment_intent_id: paymentIntentId,\r\n  });\r\n}\r\n\r\nfunction storePurchaseDetailsLocally(paymentIntentId: string,entryId?: string) {\r\n  return apiClient.post('billing/stripe/store-purchase-details-locally', {\r\n    payment_intent_id: paymentIntentId,\r\n    entry_id: entryId\r\n  });\r\n}\r\n","import { CheckoutLayout } from '../checkout-layout';\r\nimport { useParams, useSearchParams } from 'react-router';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { message } from '@ui/i18n/message';\r\nimport { CheckoutProductSummary } from '../checkout-product-summary';\r\nimport {\r\n  BillingRedirectMessage,\r\n  BillingRedirectMessageConfig,\r\n} from '../../billing-redirect-message';\r\nimport { apiClient } from '@common/http/query-client';\r\n\r\nexport function CheckoutPaypalDone() {\r\n  const { productId, priceId,entry_id:entryId } = useParams();\r\n  const [params] = useSearchParams();\r\n  const alreadyStoredLocally = useRef(false);\r\n\r\n  const [messageConfig, setMessageConfig] =\r\n    useState<BillingRedirectMessageConfig>();\r\n\r\n  useEffect(() => {\r\n    const subscriptionId = params.get('subscriptionId');\r\n    const orderId        = params.get('orderId');\r\n    const status         = params.get('status');\r\n\r\n    if (alreadyStoredLocally.current) {\r\n      return;\r\n    }\r\n\r\n    if (subscriptionId && status === 'success') {\r\n      storeSubscriptionDetailsLocally(subscriptionId).then(() => {\r\n        setMessageConfig(\r\n          getRedirectMessageConfig('success', productId, priceId),\r\n        );\r\n        window.location.href = '/billing';\r\n      });\r\n    } else if(orderId && status === 'success' && entryId){\r\n      storePurchaseDetailsLocally(orderId).then(() => {\r\n        setMessageConfig(\r\n          getRedirectMessageConfig('purchase_success', entryId),\r\n        );\r\n        window.location.href = 'drive/shares';\r\n      });\r\n    } else {\r\n      setMessageConfig(getRedirectMessageConfig(status, productId, priceId));\r\n    }\r\n    alreadyStoredLocally.current = true;\r\n  }, [priceId, productId, params,entryId]);\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <BillingRedirectMessage config={messageConfig} />\r\n      <CheckoutProductSummary showBillingLine={false} />\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction getRedirectMessageConfig(\r\n  status?: 'success' | 'error' | string | null,\r\n  productId?: string,\r\n  priceId?: string,\r\n  entryId?: string\r\n): BillingRedirectMessageConfig {\r\n  switch (status) {\r\n    case 'success':\r\n      return {\r\n        message: message('Subscription successful!'),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: '/billing',\r\n      };\r\n    case 'purchase_success':\r\n      return {\r\n        message: message('Purchase successful!'),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: 'drive/shares',\r\n      };\r\n    default:\r\n      return {\r\n        message: message('Something went wrong. Please try again.'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: errorLink(productId, priceId),\r\n      };\r\n  }\r\n}\r\n\r\nfunction errorLink(productId?: string, priceId?: string): string {\r\n  return productId && priceId ? `/checkout/${productId}/${priceId}` : '/';\r\n}\r\n\r\nfunction storeSubscriptionDetailsLocally(subscriptionId: string) {\r\n  return apiClient.post('billing/paypal/store-subscription-details-locally', {\r\n    paypal_subscription_id: subscriptionId,\r\n  });\r\n}\r\n\r\nfunction storePurchaseDetailsLocally(orderId: string,entryId?: string) {\r\n  return apiClient.post('billing/paypal/store-purchase-details-locally', {\r\n    paypal_order_id : orderId,\r\n    entry_id        : entryId\r\n  });\r\n}\r\n"],"names":["CheckoutLayout","children","left","right","useEffect","removeFromLocalStorage","Fragment","jsx","StaticPageTitle","Trans","Navbar","jsxs","CustomMenu","LocaleSwitcher","endpoint","productId","useCheckoutProduct","priceId","useParams","query","useQuery","fetchProduct","keepPreviousData","product","_a","price","p","apiClient","response","CheckoutProductSummary","showBillingLine","status","LoadingSkeleton","ProductSummary","m","FormattedPrice","ProductFeatureList","FormattedCurrency","opacityAnimation","Skeleton","findScript","url","attributes","currentScript","nextScript","createScriptElement","currentScriptClone","isExactMatch","key","insertScriptElement","onSuccess","onError","newScript","processOptions","options","sdkBaseUrl","optionsWithStringIndex","accumulator","value","camelCaseToKebabCase","queryParams","dataAttributes","objectToQueryString","str","replacer","match","indexOfMatch","params","queryString","loadScript","PromisePonyfill","validateArguments","namespace","existingWindowNamespace","getPayPalWindowNamespace","loadCustomScript","newWindowNamespace","resolve","reject","defaultError","usePaypal","type","entry_id","entry_price","data","useProducts","paypalLoadStarted","useRef","paypalButtonsRendered","paypalIsLoaded","setPaypalIsLoaded","useState","paypalElementRef","base_url","stripeEnabled","paypalEnabled","public_key","useSettings","buttons","actions","e","order","Checkout","productQuery","stripe","FullPageLoader","Navigate","StripeElementsForm","Separator","useFileEntryModel","entryIdOrUrl","entryId","extractEntryId","fetchFileEntry","parsedId","Purchase","entryQuery","entry","entryModel","_b","humanFileSize","bytes","decimals","k","sizes","i","CheckoutStripeDone","navigate","useNavigate","stripe_public_key","useSearchParams","clientSecret","messageConfig","setMessageConfig","stripeInitiated","loadStripe","getRedirectMessageConfig","payment","paymentIntent","storeSubscriptionDetailsLocally","storePurchaseDetailsLocally","BillingRedirectMessage","message","purchaseErrorLink","errorLink","paymentIntentId","CheckoutPaypalDone","alreadyStoredLocally","subscriptionId","orderId"],"mappings":"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","x_google_ignoreList":[3]}